
<!DOCTYPE html>


<html lang="en" data-content_root="./" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Kо̄manawa Kendall Stats &#8212; komanawa-kendall-stats v2.0.3 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=fd3f3429" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="_static/documentation_options.js?v=9dfb15f6"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'index';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="komanawa.kendall_stats" href="autoapi/komanawa/kendall_stats/index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="#">
  
  
  
  
  
    
    
    
    <img src="_static/ksl_for_latex.png" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">Kendall-Stats v2.0.3 Overview</p>
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="autoapi/komanawa/kendall_stats/index.html">
    Code documentation
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Komanawa-Solutions-Ltd/komanawa-kendall-stats" title="View on GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">View on GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/k%C5%8Dmanawa-solutions-ltd/" title="Follow us on LinkedIn" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Follow us on LinkedIn</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.komanawa.com" title="Kо̄manawa Solutions Ltd." class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="_static/just_symbol.png" class="icon-link-image" alt="Kо̄manawa Solutions Ltd."/></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="autoapi/komanawa/kendall_stats/index.html">
    Code documentation
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/Komanawa-Solutions-Ltd/komanawa-kendall-stats" title="View on GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">View on GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/company/k%C5%8Dmanawa-solutions-ltd/" title="Follow us on LinkedIn" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Follow us on LinkedIn</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.komanawa.com" title="Kо̄manawa Solutions Ltd." class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="_static/just_symbol.png" class="icon-link-image" alt="Kо̄manawa Solutions Ltd."/></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none"></div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="kmanawa-kendall-stats">
<h1>Kо̄manawa Kendall Stats<a class="headerlink" href="#kmanawa-kendall-stats" title="Link to this heading">#</a></h1>
<p>a small repo that holds:</p>
<ul class="simple">
<li><p>MannKendall: non parametric trend detection</p></li>
<li><p>SeasonalKendall: non parametric trend detection with seasonality</p></li>
<li><p>MultiPartKendall: non parametric change point detection</p></li>
<li><p>SeasonalMultiPartKendall: non parametric change point detection with seasonality</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Matt Dumont</p>
</dd>
<dt class="field-even">copyright<span class="colon">:</span></dt>
<dd class="field-even"><p>2024, Kо̄manawa Solutions Ltd.</p>
</dd>
<dt class="field-odd">Version<span class="colon">:</span></dt>
<dd class="field-odd"><p>v2.0.3</p>
</dd>
<dt class="field-even">Date<span class="colon">:</span></dt>
<dd class="field-even"><p>Jun 12, 2025</p>
</dd>
</dl>
<div class="toctree-wrapper compound">
</div>
<section id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>pandas&gt;=2.0.3</p></li>
<li><p>numpy&gt;=1.25.2</p></li>
<li><p>matplotlib&gt;=3.7.2</p></li>
<li><p>scipy&gt;=1.11.2</p></li>
<li><p>pytables&gt;=3.8.0</p></li>
</ul>
<p>The following command will install a virtual environment with all the dependencies:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>create<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span>--name<span class="w"> </span>kendall<span class="w"> </span><span class="nv">python</span><span class="o">=</span><span class="m">3</span>.11<span class="w"> </span><span class="nv">pandas</span><span class="o">=</span><span class="m">2</span>.0.3<span class="w"> </span><span class="nv">numpy</span><span class="o">=</span><span class="m">1</span>.25.2<span class="w"> </span><span class="nv">matplotlib</span><span class="o">=</span><span class="m">3</span>.7.2<span class="w"> </span><span class="nv">scipy</span><span class="o">=</span><span class="m">1</span>.11.2<span class="w"> </span><span class="nv">pytables</span><span class="o">=</span><span class="m">3</span>.8.0
</pre></div>
</div>
</section>
<section id="install">
<h2>Install<a class="headerlink" href="#install" title="Link to this heading">#</a></h2>
<section id="install-from-pypi">
<h3>Install from pypi<a class="headerlink" href="#install-from-pypi" title="Link to this heading">#</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>komanawa-kendall-stats
</pre></div>
</div>
</section>
<section id="install-from-github">
<h3>Install from github<a class="headerlink" href="#install-from-github" title="Link to this heading">#</a></h3>
<p>we manage this package as a simple github package, but it can still be installed by pip:</p>
<p>For the latest version use:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>git+https://github.com/Komanawa/komanawa-kendall-stats.git
</pre></div>
</div>
<p>For a specific version use:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>git+https://github.com/Komanawa/komanawa-kendall-stats.git@<span class="o">{</span>version<span class="o">}</span>

<span class="c1"># example:</span>
pip<span class="w"> </span>install<span class="w"> </span>git+https://github.com/Komanawa/komanawa-kendall-stats.git@v1.0.0
</pre></div>
</div>
</section>
</section>
<section id="update">
<h2>Update<a class="headerlink" href="#update" title="Link to this heading">#</a></h2>
<blockquote>
<div><p>option 1 is to uninstall the package with pip then reinstall it.</p>
</div></blockquote>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>uninstall<span class="w"> </span>komanawa-kendall-stats
</pre></div>
</div>
<p>otherwise, use pip update option</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>git+https://github.com/Komanawa/komanawa-kendall-stats.git<span class="w"> </span>-U
</pre></div>
</div>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading">#</a></h2>
<p>Full documentation can be found in the docstrings, but the basic usage is provided below</p>
<section id="mannkendall">
<h3>MannKendall<a class="headerlink" href="#mannkendall" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">komanawa.kendall_stats</span> <span class="kn">import</span> <span class="n">MannKendall</span><span class="p">,</span> <span class="n">example_data</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">make_increasing_decreasing_data</span><span class="p">(</span><span class="n">slope</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># to pass a simple array (no index) use data_col=None, assumes regular sampling</span>
<span class="n">mk</span> <span class="o">=</span> <span class="n">MannKendall</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">data_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rm_na</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># to assume irregular sampling, pass a pandas series, with a sortable index</span>
<span class="n">mk</span> <span class="o">=</span> <span class="n">MannKendall</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">x</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">data_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rm_na</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># to pass a dataframe, pass a data_col, and a dataframe with a sortable index</span>
<span class="n">mk</span> <span class="o">=</span> <span class="n">MannKendall</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">data_col</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">rm_na</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># note that by default, nan values are removed and the data is sorted via the series/Dataframe index,</span>
<span class="c1"># where no index is passed (e.g., np.ndarray) the index is assumed to be np.arange(len(data))</span>

<span class="c1"># the trend is accessed via the trend attribute,</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mk</span><span class="o">.</span><span class="n">trend</span><span class="p">)</span>

<span class="c1"># note the trend is stored as int (1, 0, -1) for increasing, no trend, decreasing</span>
<span class="c1"># to convert to a string use the trend_dict attribute</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mk</span><span class="o">.</span><span class="n">trend_dict</span><span class="p">[</span><span class="n">mk</span><span class="o">.</span><span class="n">trend</span><span class="p">])</span>

<span class="c1"># other attributes</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mk</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>  <span class="c1"># p value</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mk</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="c1"># z value</span>

<span class="c1"># there are two convenience methods</span>

<span class="c1"># calculate the senslope of the data</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mk</span><span class="o">.</span><span class="n">calc_senslope</span><span class="p">())</span>

<span class="c1"># plot the data and the trend</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">mk</span><span class="o">.</span><span class="n">plot_data</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Example Mann Kendall&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/example_mk.png"><img alt="_images/example_mk.png" src="_images/example_mk.png" style="height: 500px;" />
</a>
</figure>
</section>
<section id="seasonalkendall">
<h3>SeasonalKendall<a class="headerlink" href="#seasonalkendall" title="Link to this heading">#</a></h3>
<p>SeasonalKendall is as per MannKendall, but with a seasonal component.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">komanawa.kendall_stats</span> <span class="kn">import</span> <span class="n">SeasonalKendall</span><span class="p">,</span> <span class="n">example_data</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">make_seasonal_data</span><span class="p">(</span><span class="n">slope</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">unsort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">na_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># you must pass a dataframe with at least a column of data and a column of seasons for the seasonal kendall</span>
<span class="n">smk</span> <span class="o">=</span> <span class="n">SeasonalKendall</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">data_col</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">season_col</span><span class="o">=</span><span class="s1">&#39;seasons&#39;</span><span class="p">,</span> <span class="n">rm_na</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># otherwise the SeasonalKendall class is the same as the MannKendall class</span>
<span class="c1"># note that by default, nan values are removed and the data is sorted via the series/Dataframe index,</span>
<span class="c1"># where no index is passed (e.g., np.ndarray) the index is assumed to be np.arange(len(data))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">smk</span><span class="o">.</span><span class="n">trend</span><span class="p">)</span> <span class="c1"># trend as int</span>
<span class="nb">print</span><span class="p">(</span><span class="n">smk</span><span class="o">.</span><span class="n">trend_dict</span><span class="p">[</span><span class="n">smk</span><span class="o">.</span><span class="n">trend</span><span class="p">])</span> <span class="c1"># trend as string</span>
<span class="nb">print</span><span class="p">(</span><span class="n">smk</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>  <span class="c1"># p value</span>
<span class="nb">print</span><span class="p">(</span><span class="n">smk</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="c1"># z value</span>

<span class="c1"># calculate the senslope of the data</span>
<span class="nb">print</span><span class="p">(</span><span class="n">smk</span><span class="o">.</span><span class="n">calc_senslope</span><span class="p">())</span>

<span class="c1"># plot the data and the trend</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">smk</span><span class="o">.</span><span class="n">plot_data</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;example seasonal kendall&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/example_smk.png"><img alt="_images/example_smk.png" src="_images/example_smk.png" style="height: 500px;" />
</a>
</figure>
</section>
<section id="multipartkendall">
<h3>MultiPartKendall<a class="headerlink" href="#multipartkendall" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">komanawa.kendall_stats</span> <span class="kn">import</span> <span class="n">MultiPartKendall</span><span class="p">,</span> <span class="n">example_data</span>
<span class="n">plot_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">home</span><span class="p">()</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s1">&#39;Downloads&#39;</span><span class="p">,</span> <span class="s1">&#39;mk_plots&#39;</span><span class="p">)</span>
<span class="n">plot_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">x_sharp</span><span class="p">,</span> <span class="n">y_sharp</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">make_multipart_sharp_change_data</span><span class="p">(</span><span class="n">slope</span><span class="o">=</span><span class="n">example_data</span><span class="o">.</span><span class="n">multipart_sharp_slopes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                                 <span class="n">noise</span><span class="o">=</span><span class="n">example_data</span><span class="o">.</span><span class="n">multipart_sharp_noises</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                                                 <span class="n">unsort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                                 <span class="n">na_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">x_sharp</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">y_sharp</span><span class="p">)</span>
<span class="n">serial_path</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">home</span><span class="p">()</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s1">&#39;Downloads&#39;</span><span class="p">,</span> <span class="s1">&#39;multipart_mk.hdf&#39;</span><span class="p">)</span>
<span class="n">serial_path2</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">home</span><span class="p">()</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s1">&#39;Downloads&#39;</span><span class="p">,</span> <span class="s1">&#39;multipart_mk2.hdf&#39;</span><span class="p">)</span>
<span class="n">mk</span> <span class="o">=</span> <span class="n">MultiPartKendall</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>  <span class="c1"># data can be passed as a np.array, pd.Series, or pd.DataFrame</span>
    <span class="n">nparts</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>  <span class="c1"># number of parts to split data into</span>
    <span class="n">expect_part</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>  <span class="c1"># the expected slope of each part (1, increasing, 0, no change, -1, decreasing)</span>
    <span class="n">min_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">data_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>  <span class="c1"># significance level for trends (p&lt;alpha)</span>
    <span class="n">no_trend_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># significance level for no trend (p&gt;no_trend_alpha)</span>
    <span class="n">rm_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">serialise_path</span><span class="o">=</span><span class="n">serial_path</span><span class="p">,</span>  <span class="c1"># None or path to serialise results to</span>
    <span class="n">recalc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># the serialised results can be loaded back in by simply re-running the constructor with the same serialise_path</span>
<span class="c1"># if recalc is False (default) the results will be loaded from the serialised file, otherwise they will be recalculated</span>
<span class="c1"># and re-saved to the serialised file e.g.</span>
<span class="n">mk1</span> <span class="o">=</span> <span class="n">MultiPartKendall</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">nparts</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">expect_part</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">min_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">data_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                       <span class="n">no_trend_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                       <span class="n">rm_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">serialise_path</span><span class="o">=</span><span class="n">serial_path</span><span class="p">,</span> <span class="n">recalc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># equivalency is managed and will test all inputs, but the loaded object will have a different id</span>
<span class="k">assert</span> <span class="n">mk</span> <span class="o">==</span> <span class="n">mk1</span>
<span class="k">assert</span> <span class="nb">id</span><span class="p">(</span><span class="n">mk</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">id</span><span class="p">(</span><span class="n">mk1</span><span class="p">)</span>

<span class="c1"># you can also create an instance from a file</span>
<span class="n">mk2</span> <span class="o">=</span> <span class="n">MultiPartKendall</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">serial_path</span><span class="p">)</span>

<span class="c1"># you can also explicitly save the results to a file</span>
<span class="n">mk</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">save_path</span><span class="o">=</span><span class="n">serial_path2</span><span class="p">,</span> <span class="n">complevel</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">complib</span><span class="o">=</span><span class="s1">&#39;blosc:lz4&#39;</span><span class="p">)</span>

<span class="c1"># the class calculates the kendal slope for all data subsets</span>
<span class="c1"># (e.g. for the above slopes will be calculated for the data split at</span>
<span class="c1"># n where n &gt;= min_size and n&lt;= len(data)-min_size)</span>

<span class="c1"># the user can get all acceptable matches where:</span>
<span class="c1"># * the pvalue meets the criterion (p&lt;alpha for data with trends, p&gt;no_trend_alpha for data with no trend)</span>
<span class="c1"># * the trend of the data matches the expected trend</span>
<span class="n">mk</span><span class="o">.</span><span class="n">get_acceptable_matches</span><span class="p">()</span>

<span class="c1"># the user can get all matches via</span>
<span class="n">mk</span><span class="o">.</span><span class="n">get_all_matches</span><span class="p">()</span>

<span class="c1"># the user can plot match statistics (&#39;p&#39;, &#39;z&#39;, &#39;s&#39;, &#39;var_s&#39;) for all matches</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">mk</span><span class="o">.</span><span class="n">plot_acceptable_matches</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;z statistic for all acceptable matches&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plot_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s1">&#39;multi_mk_z.png&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/multi_mk_z.png"><img alt="_images/multi_mk_z.png" src="_images/multi_mk_z.png" style="height: 500px;" />
</a>
</figure>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># the user can get the best match(s)</span>
<span class="c1"># the best match is the maximum znorm_joint value where:</span>
<span class="c1">#   if expected trend == 1 or -1:</span>
<span class="c1">#     znorm = the min-max normalised z value for each part</span>
<span class="c1">#   else: (no trend expected)</span>
<span class="c1">#     znorm = 1 - the min-max normalised z value for each part</span>
<span class="c1">#   and</span>
<span class="c1">#     znorm_joint = the sum of the znorm values for each part</span>
<span class="c1"># when there are multiple matches with the same znorm_joint value both will be returned</span>
<span class="c1"># when there are no acceptable matches None will be returned</span>
<span class="c1"># or a ValueError will be raised if raise_on_none=True</span>
<span class="n">best_points</span> <span class="o">=</span> <span class="n">mk</span><span class="o">.</span><span class="n">get_maxz_breakpoints</span><span class="p">()</span>


<span class="c1"># the user can get the data, and kendall stats for a specific breakpoint</span>
<span class="n">data</span><span class="p">,</span> <span class="n">kendall_stats</span> <span class="o">=</span> <span class="n">mk</span><span class="o">.</span><span class="n">get_data_from_breakpoints</span><span class="p">(</span><span class="n">breakpoints</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span> <span class="c1"># get the data split at point 50</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="c1"># list containing the data for each part</span>
<span class="c1"># kendal stats for each part: &#39;trend&#39;, &#39;h&#39;, &#39;p&#39;, &#39;z&#39;, &#39;s&#39;, &#39;var_s&#39;, &#39;senslope&#39;, &#39;senintercept&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">kendall_stats</span><span class="p">)</span>

<span class="c1"># the user can also plot the data from a specific breakpoint</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">mk</span><span class="o">.</span><span class="n">plot_data_from_breakpoints</span><span class="p">(</span><span class="n">breakpoints</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">txt_vloc</span><span class="o">=-</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">add_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;data split at 50&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plot_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s1">&#39;multi_mk_data.png&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/multi_mk_data.png"><img alt="_images/multi_mk_data.png" src="_images/multi_mk_data.png" style="height: 500px;" />
</a>
</figure>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># user can specify any number of parts to split data into</span>
<span class="n">x_para</span><span class="p">,</span> <span class="n">y_para</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">make_multipart_parabolic_data</span><span class="p">(</span><span class="n">slope</span><span class="o">=</span><span class="n">example_data</span><span class="o">.</span><span class="n">multipart_parabolic_slopes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                            <span class="n">noise</span><span class="o">=</span><span class="n">example_data</span><span class="o">.</span><span class="n">multipart_parabolic_noises</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                                            <span class="n">unsort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                            <span class="n">na_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">x_para</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">y_para</span><span class="p">)</span>
<span class="n">mk</span> <span class="o">=</span> <span class="n">MultiPartKendall</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>  <span class="c1"># data can be passed as a np.array, pd.Series, or pd.DataFrame</span>
    <span class="n">nparts</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>  <span class="c1"># number of parts to split data into</span>
    <span class="n">expect_part</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>  <span class="c1"># the expected slope of each part (1, increasing, 0, no change, -1, decreasing)</span>
    <span class="n">min_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">data_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>  <span class="c1"># significance level for trends (p&lt;alpha)</span>
    <span class="n">no_trend_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># significance level for no trend (p&gt;no_trend_alpha)</span>
    <span class="n">rm_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">serialise_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># None or path to serialise results to</span>
    <span class="n">recalc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">mk</span><span class="o">.</span><span class="n">plot_data_from_breakpoints</span><span class="p">(</span><span class="n">breakpoints</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span> <span class="n">txt_vloc</span><span class="o">=-</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">add_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;data split at 40 and 60&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plot_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s1">&#39;multi_mk_data2.png&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/multi_mk_data2.png"><img alt="_images/multi_mk_data2.png" src="_images/multi_mk_data2.png" style="height: 500px;" />
</a>
</figure>
</section>
<section id="seasonalmultipartkendall">
<h3>SeasonalMultiPartKendall<a class="headerlink" href="#seasonalmultipartkendall" title="Link to this heading">#</a></h3>
<p>The SeasonalMultiPartKendall is as per the MultiPartKendall, but with a seasonal component.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">komanawa.kendall_stats</span> <span class="kn">import</span> <span class="n">SeasonalMultiPartKendall</span><span class="p">,</span> <span class="n">example_data</span>
<span class="n">plot_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">home</span><span class="p">()</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s1">&#39;Downloads&#39;</span><span class="p">,</span> <span class="s1">&#39;smk_plots&#39;</span><span class="p">)</span>
<span class="n">plot_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">make_seasonal_multipart_sharp_change</span><span class="p">(</span><span class="n">slope</span><span class="o">=</span><span class="n">example_data</span><span class="o">.</span><span class="n">multipart_sharp_slopes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                                 <span class="n">noise</span><span class="o">=</span><span class="n">example_data</span><span class="o">.</span><span class="n">multipart_sharp_noises</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                                                 <span class="n">unsort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                                 <span class="n">na_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># initalisation is identical to MultiPartKendall except that data must be a DataFrame</span>
<span class="c1"># and data_col and seasonal_col must be specified</span>

<span class="n">smk</span> <span class="o">=</span> <span class="n">SeasonalMultiPartKendall</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>  <span class="c1"># data can be passed as a np.array, pd.Series, or pd.DataFrame</span>
    <span class="n">nparts</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>  <span class="c1"># number of parts to split data into</span>
    <span class="n">expect_part</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>  <span class="c1"># the expected slope of each part (1, increasing, 0, no change, -1, decreasing)</span>
    <span class="n">min_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">data_col</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
    <span class="n">season_col</span><span class="o">=</span><span class="s1">&#39;seasons&#39;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>  <span class="c1"># significance level for trends (p&lt;alpha)</span>
    <span class="n">no_trend_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># significance level for no trend (p&gt;no_trend_alpha)</span>
    <span class="n">rm_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">serialise_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># None or path to serialise results to</span>
    <span class="n">recalc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># the user can also plot the data from a specific breakpoint</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">smk</span><span class="o">.</span><span class="n">plot_data_from_breakpoints</span><span class="p">(</span><span class="n">breakpoints</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">txt_vloc</span><span class="o">=-</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">add_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;data split at 50&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plot_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s1">&#39;multi_smk_data.png&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/multi_smk_data.png"><img alt="_images/multi_smk_data.png" src="_images/multi_smk_data.png" style="height: 500px;" />
</a>
</figure>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># user can specify any number of parts to split data into</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">make_seasonal_multipart_parabolic</span><span class="p">(</span><span class="n">slope</span><span class="o">=</span><span class="n">example_data</span><span class="o">.</span><span class="n">multipart_parabolic_slopes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                            <span class="n">noise</span><span class="o">=</span><span class="n">example_data</span><span class="o">.</span><span class="n">multipart_parabolic_noises</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                                            <span class="n">unsort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                            <span class="n">na_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">smk</span> <span class="o">=</span> <span class="n">SeasonalMultiPartKendall</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>  <span class="c1"># data can be passed as a np.array, pd.Series, or pd.DataFrame</span>
    <span class="n">nparts</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>  <span class="c1"># number of parts to split data into</span>
    <span class="n">expect_part</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>  <span class="c1"># the expected slope of each part (1, increasing, 0, no change, -1, decreasing)</span>
    <span class="n">min_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">data_col</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
    <span class="n">season_col</span><span class="o">=</span><span class="s1">&#39;seasons&#39;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>  <span class="c1"># significance level for trends (p&lt;alpha)</span>
    <span class="n">no_trend_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># significance level for no trend (p&gt;no_trend_alpha)</span>
    <span class="n">rm_na</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">serialise_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># None or path to serialise results to</span>
    <span class="n">recalc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">smk</span><span class="o">.</span><span class="n">plot_data_from_breakpoints</span><span class="p">(</span><span class="n">breakpoints</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span> <span class="n">txt_vloc</span><span class="o">=-</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">add_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;data split at 40 and 60&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plot_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s1">&#39;multi_smk_data2.png&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/multi_smk_data2.png"><img alt="_images/multi_smk_data2.png" src="_images/multi_smk_data2.png" style="height: 500px;" />
</a>
</figure>
</section>
</section>
<section id="resource-requirements">
<h2>Resource Requirements<a class="headerlink" href="#resource-requirements" title="Link to this heading">#</a></h2>
<p>Note that Mann Kendall tests require calculating the covariance matrix of the data, which creates a NxN matrix where N is the length of the data.  In addition the Multipart Kendall analysis requires indexing all possible combinations of data splits, which is a factorial problem.  As such, the resource requirements for these tests can be quite high.  The following table provides some rough estimates of the resource requirements for the tests.</p>
<section id="theoretical-memory-requirements">
<h3>Theoretical memory requirements<a class="headerlink" href="#theoretical-memory-requirements" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>N: 4 * s_array memory</p></li>
<li><p>50: 8e-05 gb</p></li>
<li><p>100: 0.00032 gb</p></li>
<li><p>500: 0.008 gb</p></li>
<li><p>1,000: 0.032 gb</p></li>
<li><p>5,000: 0.8 gb</p></li>
<li><p>10,000: 3.2 gb</p></li>
<li><p>25,000: 20.0 gb</p></li>
<li><p>50,000: 80.0 gb</p></li>
</ul>
</section>
<section id="processing-time">
<h3>Processing Time<a class="headerlink" href="#processing-time" title="Link to this heading">#</a></h3>
<p>The table of processing times was run on a single thread (11th Gen Intel(R) Core(TM) i5-11500H &#64; 2.90GHz with 32 GB of DDR4 RAM). The results are in seconds If you want a processing time table for a different machine run:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">komanawa.kendall_stats.time_tests</span> <span class="kn">import</span> <span class="n">run_time_test</span>
<span class="n">run_time_test</span><span class="p">(</span><span class="n">outdir</span><span class="o">=</span><span class="n">Path</span><span class="o">.</span><span class="n">home</span><span class="p">()</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s1">&#39;Downloads&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>Note that this may take some time</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>npoints</p></th>
<th class="head"><p>MannKendall_time_test</p></th>
<th class="head"><p>SeasonalKendall_time_test</p></th>
<th class="head"><p>MultiPartKendall_2part_time_test</p></th>
<th class="head"><p>SeasonalMultiPartKendall_2part_time_test</p></th>
<th class="head"><p>MultiPartKendall_3part_time_test</p></th>
<th class="head"><p>SeasonalMultiPartKendall_3part_time_test</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>50</p></td>
<td><p>1.13E-03</p></td>
<td><p>4.21E-03</p></td>
<td><p>1.65E-02</p></td>
<td><p>2.15E-02</p></td>
<td><p>5.19E-02</p></td>
<td><p>7.75E-02</p></td>
</tr>
<tr class="row-odd"><td><p>100</p></td>
<td><p>5.10E-04</p></td>
<td><p>1.76E-03</p></td>
<td><p>2.91E-02</p></td>
<td><p>6.25E-02</p></td>
<td><p>4.18E-01</p></td>
<td><p>7.62E-01</p></td>
</tr>
<tr class="row-even"><td><p>500</p></td>
<td><p>3.04E-03</p></td>
<td><p>5.89E-03</p></td>
<td><p>1.93E-01</p></td>
<td><p>7.60E-01</p></td>
<td><p>2.04E+01</p></td>
<td><p>6.48E+01</p></td>
</tr>
<tr class="row-odd"><td><p>1000</p></td>
<td><p>9.40E-03</p></td>
<td><p>3.36E-02</p></td>
<td><p>7.65E-01</p></td>
<td><p>6.40E+00</p></td>
<td><p>1.27E+02</p></td>
<td><p>6.91E+02</p></td>
</tr>
<tr class="row-even"><td><p>5000</p></td>
<td><p>2.08E+00</p></td>
<td><p>3.04E+00</p></td>
<td><p>6.33E+01</p></td>
<td><p>3.97E+03</p></td>
<td><p>na</p></td>
<td><p>na</p></td>
</tr>
<tr class="row-odd"><td><p>10000</p></td>
<td><p>9.81E+00</p></td>
<td><p>1.50E+01</p></td>
<td><p>4.03E+02</p></td>
<td><p>4.18E+04</p></td>
<td><p>na</p></td>
<td><p>na</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="options-for-reduced-computational-requirements-multipartmannkendall-and-multipartseasonalmannkendall">
<h3>Options for reduced computational requirements (MultipartMannKendall and MultipartSeasonalMannKendall)<a class="headerlink" href="#options-for-reduced-computational-requirements-multipartmannkendall-and-multipartseasonalmannkendall" title="Link to this heading">#</a></h3>
<p>The MultipartMannKendall and MultipartSeasonalMannKendall classes have a two options to reduce the computational requirements of the analysis.  These options are:</p>
<ol class="arabic simple">
<li><p>changing the check_step parameter, which controls the step size of the data splits (e.g. when check_step=1, all possible data splits are checked, when check_step=2, every second data split is checked, etc.)</p></li>
<li><p>changing the check_window parameter, which controls the data which will be checked for matches.  For example when check_window=None all data splits will be checked, when check_window=(30,60) for a two part kendall only data splits between 30 and 60 will be checked.  Similarly, when check_window=[(30,50), (60,80) for a three part kendall only data splits between 30 and 50, and 60 and 80 will be checked for the first and and second breakpoints, respectively.</p></li>
</ol>
<p>Either of these options can significantly reduce the runtime of the analysis, but may influance the choice of breakpoint, so use these options with care.  The table below demonstrates the time gains from these approaches on a MultipartMannKendall with 1000 datapoints. Results are in seconds.  Note that the full s_array (nxn) is still calculated, so these approaches will not reduce the memory requirements of the analysis.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>window: None</p></th>
<th class="head"><p>window: (300, 700)</p></th>
<th class="head"><p>window: (400, 600)</p></th>
<th class="head"><p>window: (450,550)</p></th>
<th class="head"><p>window: (475,525)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>step: 1</p></td>
<td><p>0.68</p></td>
<td><p>0.27</p></td>
<td><p>0.18</p></td>
<td><p>0.08</p></td>
<td><p>0.10</p></td>
</tr>
<tr class="row-odd"><td><p>step: 2</p></td>
<td><p>0.35</p></td>
<td><p>0.18</p></td>
<td><p>0.08</p></td>
<td><p>0.08</p></td>
<td><p>0.04</p></td>
</tr>
<tr class="row-even"><td><p>step: 5</p></td>
<td><p>0.20</p></td>
<td><p>0.07</p></td>
<td><p>0.08</p></td>
<td><p>0.03</p></td>
<td><p>0.07</p></td>
</tr>
<tr class="row-odd"><td><p>step: 10</p></td>
<td><p>0.10</p></td>
<td><p>0.09</p></td>
<td><p>0.03</p></td>
<td><p>0.07</p></td>
<td><p>0.03</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="right-next"
       href="autoapi/komanawa/kendall_stats/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">komanawa.kendall_stats</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies">Dependencies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install">Install</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-from-pypi">Install from pypi</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#install-from-github">Install from github</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#update">Update</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage">Usage</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mannkendall">MannKendall</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seasonalkendall">SeasonalKendall</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multipartkendall">MultiPartKendall</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seasonalmultipartkendall">SeasonalMultiPartKendall</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resource-requirements">Resource Requirements</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#theoretical-memory-requirements">Theoretical memory requirements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#processing-time">Processing Time</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#options-for-reduced-computational-requirements-multipartmannkendall-and-multipartseasonalmannkendall">Options for reduced computational requirements (MultipartMannKendall and MultipartSeasonalMannKendall)</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Kо̄manawa Solutions Ltd..
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>